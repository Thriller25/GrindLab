# Testing / Smoke checklist

Единый чек-лист для ручной проверки и обязательных команд перед любым PR. Не меняет бизнес-логику и JSON-контракты, а фиксирует ожидаемое поведение.

## Smoke сценарии
- **Главная**: страница открывается без 500, дашборд/лендинг прогружается, есть доступ к основным переходам (проекты, расчёты, сравнения), данные подставляются из последнего успешного расчёта.
- **Фильтры проекта**: на странице с поиском/списком расчётов фильтры (проект/flowsheet/дата/статус) применяются, выдача обновляется; при сбросе фильтров возвращается полный список; пустая выдача отображает корректный empty state без ошибок.
- **Деталка расчёта**: карточка/страница расчёта открывается из списка или прямой ссылкой; видны входные данные, KPI, графики; переход на связанную версию схемы (flowsheet version) работает.
- **Сравнение**: сравнение двух и более расчётов строится, таблицы и графики рендерятся; навигация по вкладкам сравнения не даёт ошибок; ручное обновление страницы не ломает состояние.
- **Проекты (список)**: страница проектов открывается, список подхватывает пагинацию/поиск, переходы в проект работают.
- **Проект (деталь)**: страница проекта загружается, видно версии схемы/расчёты/комментарии, кнопки действий ведут на корректные экраны (новый расчёт, сравнение, просмотр версии схемы).

## Негативные сценарии
- Фильтры или поиск дают **0 результатов**: отображается пустое состояние/сообщение, без падений запроса.
- **Backend недоступен**: фронт показывает контролируемую ошибку/плашку, нет бесконечной загрузки и 500 на клиенте.
- **Старые демо-раны с неполным input**: при сравнении такие расчёты не вызывают 500; строки/значения без данных помечены заглушками, сравнение остаётся доступным.

## Команды проверок перед PR
- **Backend** (из `backend/`):
  - Bash/zsh: `python -m py_compile app/**/*.py`
  - PowerShell: `python -m py_compile (Get-ChildItem app -Recurse -Filter *.py).FullName`
- **Frontend** (из `frontend/`): `npm run build` и `npm run typecheck` (если скрипт доступен; минимум `npm run build`)

## PR checklist
Добавлять в описание PR короткий блок:

```
Backend: <краткое описание изменений или "нет изменений">
Frontend: <краткое описание изменений или "нет изменений">

- [ ] Smoke сценарии пройдены (главная → фильтры проекта → деталка расчёта → сравнение → проекты → проект)
- [ ] Негативные сценарии проверены (0 результатов, backend недоступен, сравнение старых демо-ранов без 500)
- [ ] Backend: python -m py_compile app/**/*.py (PowerShell: `python -m py_compile (Get-ChildItem app -Recurse -Filter *.py).FullName`)
- [ ] Frontend: npm run build
- [ ] Frontend: npm run typecheck (если есть)
```

## Demo data (seed)
- Запустить сидер:
  - `cd backend`
  - `python -m app.scripts.seed_demo`
- Проверка через API: открыть http://127.0.0.1:8000/docs и вызвать `GET /api/me/dashboard` (AUTH_ENABLED=false) — должны быть демо-проекты и расчёты.
- Проверка через UI: запустить фронт (`npm run dev` в `frontend/`) и убедиться, что дашборд и список расчётов заполнены демо-данными.
